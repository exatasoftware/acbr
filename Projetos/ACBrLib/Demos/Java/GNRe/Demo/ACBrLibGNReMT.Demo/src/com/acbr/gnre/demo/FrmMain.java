/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.acbr.gnre.demo;

import com.acbr.ACBrSessao;
import static com.acbr.ACBrSessao.DFe;
import static com.acbr.ACBrSessao.GNRe;
import static com.acbr.ACBrSessao.Proxy;
import com.acbr.gnre.ACBrGNRe;
import java.awt.Dialog;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.HashSet;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;

/**
 *
 * @author rften
 */
public class FrmMain extends javax.swing.JFrame {

    private ACBrGNRe acbrGNRe;

    /**
     * Creates new form FrmMain
     */
    public FrmMain() {
        initComponents();
        try {
            acbrGNRe = new ACBrGNRe();
        } catch (Exception ex) {
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel8 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        rtbRespostas = new javax.swing.JTextArea();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel13 = new javax.swing.JPanel();
        chkExibirErroSchema = new javax.swing.JCheckBox();
        lblFormatoAlerta = new javax.swing.JLabel();
        txtFormatAlerta = new javax.swing.JTextField();
        lblVersDocFiscal = new javax.swing.JLabel();
        cmbFormaEmissao = new javax.swing.JComboBox<>();
        lblFormaEmissao1 = new javax.swing.JLabel();
        cmbVersDocFiscal = new javax.swing.JComboBox<>();
        chkRetAcentXMLsEnv = new javax.swing.JCheckBox();
        chkSalArqEnvEResp = new javax.swing.JCheckBox();
        txtPastaLogs = new javax.swing.JTextField();
        btnPastaLogs = new javax.swing.JButton();
        lblVersDocFiscal1 = new javax.swing.JLabel();
        lblVersDocFiscal2 = new javax.swing.JLabel();
        txtPastaSchema = new javax.swing.JTextField();
        btnPastaSchemas = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        cmbUfDestino = new javax.swing.JComboBox<>();
        jLabel2 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        cmbSSlType = new javax.swing.JComboBox<>();
        nudTimeOut = new javax.swing.JSpinner();
        jLabel7 = new javax.swing.JLabel();
        jPanel6 = new javax.swing.JPanel();
        rdbHomologacao = new javax.swing.JRadioButton();
        rdbProducao = new javax.swing.JRadioButton();
        jPanel7 = new javax.swing.JPanel();
        jLabel8 = new javax.swing.JLabel();
        txtProxyServidor = new javax.swing.JTextField();
        nudProxyPorta = new javax.swing.JSpinner();
        jLabel9 = new javax.swing.JLabel();
        txtProxyUsuario = new javax.swing.JTextField();
        jLabel10 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        txtProxySenha = new javax.swing.JPasswordField();
        chkVisualizarmsg = new javax.swing.JCheckBox();
        chkSalvarEnvelopeSOAP = new javax.swing.JCheckBox();
        jPanel14 = new javax.swing.JPanel();
        nudIntervalos = new javax.swing.JSpinner();
        lblIntervalo = new javax.swing.JLabel();
        chkAjustarAut = new javax.swing.JCheckBox();
        lblTentativas = new javax.swing.JLabel();
        nudTentativas = new javax.swing.JSpinner();
        lblAguardar = new javax.swing.JLabel();
        nudAguardar = new javax.swing.JSpinner();
        jPanel3 = new javax.swing.JPanel();
        jLabel12 = new javax.swing.JLabel();
        cmbCrypt = new javax.swing.JComboBox<>();
        jLabel13 = new javax.swing.JLabel();
        cmbHttp = new javax.swing.JComboBox<>();
        jLabel14 = new javax.swing.JLabel();
        cmbXmlSign = new javax.swing.JComboBox<>();
        jPanel9 = new javax.swing.JPanel();
        jLabel15 = new javax.swing.JLabel();
        txtCertPath = new javax.swing.JTextField();
        btnSelectCert = new javax.swing.JButton();
        jLabel16 = new javax.swing.JLabel();
        jLabel17 = new javax.swing.JLabel();
        txtCertNumero = new javax.swing.JTextField();
        txtCertPassword = new javax.swing.JPasswordField();
        txtDadosPFX = new javax.swing.JTextField();
        lblDadosPFX = new javax.swing.JLabel();
        btnDadosPFX = new javax.swing.JButton();
        btnObterCertificados = new javax.swing.JButton();
        jPanel5 = new javax.swing.JPanel();
        txtArqGNRe = new javax.swing.JTextField();
        btnSelectCert1 = new javax.swing.JButton();
        jLabel26 = new javax.swing.JLabel();
        ckbSalvarArqs = new javax.swing.JCheckBox();
        ckbPastaMensal = new javax.swing.JCheckBox();
        ckbAdicionaLiteral = new javax.swing.JCheckBox();
        ckbEmissaoPathGNRe = new javax.swing.JCheckBox();
        ckbSepararPorCNPJ = new javax.swing.JCheckBox();
        ckbSepararPorModelo = new javax.swing.JCheckBox();
        jPanel4 = new javax.swing.JPanel();
        jPanel10 = new javax.swing.JPanel();
        jLabel18 = new javax.swing.JLabel();
        txtNome = new javax.swing.JTextField();
        jLabel19 = new javax.swing.JLabel();
        txtEmail = new javax.swing.JTextField();
        jLabel20 = new javax.swing.JLabel();
        txtHost = new javax.swing.JTextField();
        jLabel21 = new javax.swing.JLabel();
        nudPorta = new javax.swing.JSpinner();
        txtUsuario = new javax.swing.JTextField();
        jLabel22 = new javax.swing.JLabel();
        jLabel23 = new javax.swing.JLabel();
        ckbSSL = new javax.swing.JCheckBox();
        ckbTLS = new javax.swing.JCheckBox();
        txtSenha = new javax.swing.JPasswordField();
        jLabel24 = new javax.swing.JLabel();
        txtAssunto = new javax.swing.JTextField();
        jLabel25 = new javax.swing.JLabel();
        jScrollPane2 = new javax.swing.JScrollPane();
        txtMensagem = new javax.swing.JTextArea();
        btnSalvar = new javax.swing.JButton();
        btnCarregarConfig = new javax.swing.JButton();
        jTabbedPane3 = new javax.swing.JTabbedPane();
        jPanel11 = new javax.swing.JPanel();
        btnGerarXML = new javax.swing.JButton();
        btnEnviar = new javax.swing.JButton();
        btnCarregarININFe = new javax.swing.JButton();
        btnCarregarXMLNFe = new javax.swing.JButton();
        btnLimparLista = new javax.swing.JButton();
        btnImprimirDANFe = new javax.swing.JButton();
        btnImprimirPDFDANFe = new javax.swing.JButton();
        btnEnviarEmail = new javax.swing.JButton();
        jPanel12 = new javax.swing.JPanel();
        btnConfigUF = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("ACBrLibGNRe Demo");
        setAutoRequestFocus(false);
        setSize(new java.awt.Dimension(800, 600));
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowActivated(java.awt.event.WindowEvent evt) {
                formWindowActivated(evt);
            }
        });

        jPanel8.setBorder(javax.swing.BorderFactory.createTitledBorder("Respostas"));

        rtbRespostas.setColumns(20);
        rtbRespostas.setRows(5);
        jScrollPane1.setViewportView(rtbRespostas);

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane1)
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane1)
        );

        chkExibirErroSchema.setText("Exibir Erro Schema");

        lblFormatoAlerta.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        lblFormatoAlerta.setText("Formato Alerta");

        lblVersDocFiscal.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        lblVersDocFiscal.setText("Versão Documento Fiscal");

        lblFormaEmissao1.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        lblFormaEmissao1.setText("Forma de Emissão");

        chkRetAcentXMLsEnv.setText("Retirar Acentos dos XMLs enviados");

        chkSalArqEnvEResp.setText("Salvar Arquivos de Envio e Resposta");

        btnPastaLogs.setText("...");
        btnPastaLogs.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnPastaLogsActionPerformed(evt);
            }
        });

        lblVersDocFiscal1.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        lblVersDocFiscal1.setText("Pasta dos Logs");

        lblVersDocFiscal2.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        lblVersDocFiscal2.setText("Pasta dos Schemas");

        btnPastaSchemas.setText("...");
        btnPastaSchemas.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnPastaSchemasActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel13Layout = new javax.swing.GroupLayout(jPanel13);
        jPanel13.setLayout(jPanel13Layout);
        jPanel13Layout.setHorizontalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(txtFormatAlerta)
                    .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(chkSalArqEnvEResp)
                        .addComponent(lblFormatoAlerta)
                        .addComponent(chkExibirErroSchema)
                        .addComponent(lblVersDocFiscal)
                        .addComponent(cmbFormaEmissao, javax.swing.GroupLayout.PREFERRED_SIZE, 162, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(lblFormaEmissao1)
                        .addComponent(cmbVersDocFiscal, javax.swing.GroupLayout.PREFERRED_SIZE, 162, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(chkRetAcentXMLsEnv)
                        .addGroup(jPanel13Layout.createSequentialGroup()
                            .addComponent(txtPastaLogs, javax.swing.GroupLayout.PREFERRED_SIZE, 302, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(btnPastaLogs, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addComponent(lblVersDocFiscal1)
                        .addComponent(lblVersDocFiscal2)
                        .addGroup(jPanel13Layout.createSequentialGroup()
                            .addComponent(txtPastaSchema, javax.swing.GroupLayout.PREFERRED_SIZE, 302, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(btnPastaSchemas, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addContainerGap(25, Short.MAX_VALUE))
        );
        jPanel13Layout.setVerticalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(chkExibirErroSchema)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(lblFormatoAlerta)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtFormatAlerta, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblFormaEmissao1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cmbFormaEmissao, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblVersDocFiscal)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cmbVersDocFiscal, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(chkRetAcentXMLsEnv)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(chkSalArqEnvEResp)
                .addGap(11, 11, 11)
                .addComponent(lblVersDocFiscal1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtPastaLogs, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnPastaLogs, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addComponent(lblVersDocFiscal2)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtPastaSchema, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnPastaSchemas, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(127, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Geral", jPanel13);

        cmbUfDestino.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "AC", "AL", "AM", "AP", "BA", "CE", "DF", "ES", "GO", "MA", "MG", "MS", "MT", "PA", "PB", "PE", "PI", "PR", "RJ", "RN", "RO", "RR", "RS", "SC", "SE", "SP", "TO" }));

        jLabel2.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel2.setText("UF Destino");

        jLabel6.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel6.setText("SSL Type");

        cmbSSlType.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "LT_all", "LT_SSLv2", "LT_SSLv3", "LT_TLSv1", "LT_TLSv1_1", "LT_TLSv1_2", "LT_SSHv2" }));

        nudTimeOut.setModel(new javax.swing.SpinnerNumberModel(5000, 1, null, 1));

        jLabel7.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel7.setText("TimeOut");

        jPanel6.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Ambiente", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 11))); // NOI18N

        rdbHomologacao.setText("Homologação");

        rdbProducao.setText("Produção");
        rdbProducao.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rdbProducaoActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(rdbProducao)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(rdbHomologacao)
                .addGap(37, 37, 37))
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(rdbHomologacao)
                    .addComponent(rdbProducao))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel7.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Proxy", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 11))); // NOI18N

        jLabel8.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel8.setText("Servidor");

        nudProxyPorta.setModel(new javax.swing.SpinnerNumberModel(5000, 1, null, 1));

        jLabel9.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel9.setText("Porta");

        jLabel10.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel10.setText("Usuário");

        jLabel11.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel11.setText("Senha");

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtProxyServidor, javax.swing.GroupLayout.PREFERRED_SIZE, 138, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel8))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel7Layout.createSequentialGroup()
                                .addComponent(jLabel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addGap(13, 13, 13))
                            .addComponent(nudProxyPorta)))
                    .addComponent(txtProxyUsuario)
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel10)
                            .addComponent(jLabel11))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(txtProxySenha))
                .addContainerGap())
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(jLabel9)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(nudProxyPorta, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(jLabel8)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txtProxyServidor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel10)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtProxyUsuario, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel11)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtProxySenha, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        chkVisualizarmsg.setText("Visualizar Mensagem");

        chkSalvarEnvelopeSOAP.setText("Salvar envelope SOAP");

        jPanel14.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Retorno de Envio", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 11))); // NOI18N

        nudIntervalos.setModel(new javax.swing.SpinnerNumberModel(5000, 1, null, 1));

        lblIntervalo.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        lblIntervalo.setText("Intervalo");

        chkAjustarAut.setText("Ajustar Automaticamente prop. \"Aguardar\"");

        lblTentativas.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        lblTentativas.setText("Tentativas");

        nudTentativas.setModel(new javax.swing.SpinnerNumberModel(5000, 1, null, 1));

        lblAguardar.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        lblAguardar.setText("Aguardar");

        nudAguardar.setModel(new javax.swing.SpinnerNumberModel(5000, 1, null, 1));

        javax.swing.GroupLayout jPanel14Layout = new javax.swing.GroupLayout(jPanel14);
        jPanel14.setLayout(jPanel14Layout);
        jPanel14Layout.setHorizontalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel14Layout.createSequentialGroup()
                .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel14Layout.createSequentialGroup()
                        .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblAguardar)
                            .addComponent(nudAguardar, javax.swing.GroupLayout.PREFERRED_SIZE, 87, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(59, 59, 59)
                        .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblTentativas)
                            .addComponent(nudTentativas, javax.swing.GroupLayout.PREFERRED_SIZE, 87, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addComponent(chkAjustarAut))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblIntervalo)
                    .addComponent(nudIntervalos, javax.swing.GroupLayout.PREFERRED_SIZE, 87, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );
        jPanel14Layout.setVerticalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel14Layout.createSequentialGroup()
                .addComponent(chkAjustarAut)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 9, Short.MAX_VALUE)
                .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel14Layout.createSequentialGroup()
                        .addComponent(lblIntervalo)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(nudIntervalos, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel14Layout.createSequentialGroup()
                        .addComponent(lblAguardar)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(nudAguardar, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel14Layout.createSequentialGroup()
                        .addComponent(lblTentativas)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(nudTentativas, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jLabel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(cmbUfDestino, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(cmbSSlType, javax.swing.GroupLayout.PREFERRED_SIZE, 95, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 70, Short.MAX_VALUE))
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(jLabel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addGap(50, 50, 50)))
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(jLabel7, javax.swing.GroupLayout.DEFAULT_SIZE, 112, Short.MAX_VALUE)
                                .addGap(23, 23, 23))
                            .addComponent(nudTimeOut, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                        .addComponent(jPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addContainerGap())
                    .addComponent(jPanel14, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(chkVisualizarmsg)
                            .addComponent(chkSalvarEnvelopeSOAP))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(jPanel7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel2)
                    .addComponent(jLabel6)
                    .addComponent(jLabel7))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(cmbUfDestino, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cmbSSlType, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(nudTimeOut, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(chkVisualizarmsg)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(chkSalvarEnvelopeSOAP)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel14, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(38, 38, 38))
        );

        jTabbedPane1.addTab("Webservices", jPanel2);

        jLabel12.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel12.setText("CryptLib");

        cmbCrypt.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "cryNone", "cryOpenSSL", "cryCapicom", "cryWinCrypt" }));

        jLabel13.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel13.setText("HttpLib");

        cmbHttp.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "httpNone", "httpWinINet", "httpWinHttp", "httpOpenSSL", "httpIndy" }));

        jLabel14.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel14.setText("XmlSignLib");

        cmbXmlSign.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "xsNone", "xsXmlSec", "xsMsXml", "xsMsXmlCapicom", "xsLibXml2" }));

        jPanel9.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Certificados", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 11))); // NOI18N

        jLabel15.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel15.setText("Caminho");

        btnSelectCert.setText("...");
        btnSelectCert.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSelectCertActionPerformed(evt);
            }
        });

        jLabel16.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel16.setText("Senha");

        jLabel17.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel17.setText("Número de Série");

        lblDadosPFX.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        lblDadosPFX.setText("Dados PFX");

        btnDadosPFX.setText("...");
        btnDadosPFX.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnDadosPFXActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtCertPath)
                    .addComponent(txtDadosPFX)
                    .addGroup(jPanel9Layout.createSequentialGroup()
                        .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel15)
                            .addComponent(lblDadosPFX))
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btnSelectCert, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnDadosPFX, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)))
            .addComponent(txtCertPassword)
            .addComponent(txtCertNumero)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel16)
                    .addComponent(jLabel17))
                .addGap(0, 0, Short.MAX_VALUE))
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel9Layout.createSequentialGroup()
                .addComponent(jLabel15)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtCertPath, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnSelectCert))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblDadosPFX)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtDadosPFX, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnDadosPFX))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel16)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtCertPassword, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel17)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtCertNumero, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        btnObterCertificados.setText("Obter Certificados");

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel12)
                            .addComponent(cmbCrypt, javax.swing.GroupLayout.PREFERRED_SIZE, 196, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel13)
                            .addComponent(cmbHttp, javax.swing.GroupLayout.PREFERRED_SIZE, 196, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel14)
                            .addComponent(cmbXmlSign, javax.swing.GroupLayout.PREFERRED_SIZE, 196, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(btnObterCertificados, javax.swing.GroupLayout.PREFERRED_SIZE, 122, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(0, 160, Short.MAX_VALUE)))
                .addContainerGap())
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel12)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cmbCrypt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel13)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cmbHttp, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel14)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cmbXmlSign, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnObterCertificados)
                .addContainerGap(76, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Certificados", jPanel3);

        btnSelectCert1.setText("jButton1");
        btnSelectCert1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSelectCert1ActionPerformed(evt);
            }
        });

        jLabel26.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel26.setText("Pasta Arquivos GNRe");

        ckbSalvarArqs.setText("Salvar Arquivos em Pastas Separadas");

        ckbPastaMensal.setText("Criar Pastas Mensalmente");

        ckbAdicionaLiteral.setText("Adicionar Literal no nome das pastas");

        ckbEmissaoPathGNRe.setText("Salvar Documento pelo campo Data de Emissão");

        ckbSepararPorCNPJ.setText("Separar Arqs pelo CNPJ do Certificado");

        ckbSepararPorModelo.setText("Separar Arqs pelo Modelo do Documento");

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(ckbSalvarArqs)
                    .addComponent(ckbPastaMensal)
                    .addComponent(ckbAdicionaLiteral)
                    .addComponent(ckbEmissaoPathGNRe)
                    .addComponent(ckbSepararPorCNPJ)
                    .addComponent(ckbSepararPorModelo)
                    .addComponent(jLabel26))
                .addGap(0, 125, Short.MAX_VALUE))
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addComponent(txtArqGNRe)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnSelectCert1, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(37, 37, 37))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addComponent(ckbSalvarArqs)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(ckbPastaMensal)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(ckbAdicionaLiteral)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(ckbEmissaoPathGNRe)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(ckbSepararPorCNPJ)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(ckbSepararPorModelo)
                .addGap(18, 18, 18)
                .addComponent(jLabel26)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtArqGNRe, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnSelectCert1))
                .addContainerGap(261, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Arquivos", jPanel5);

        jPanel10.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Configurações", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 1, 11))); // NOI18N

        jLabel18.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel18.setText("Nome");

        jLabel19.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel19.setText("Host SMTP");

        jLabel20.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel20.setText("Email");

        jLabel21.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel21.setText("Porta");

        nudPorta.setModel(new javax.swing.SpinnerNumberModel(5000, 1, null, 1));

        jLabel22.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel22.setText("Usuário");

        jLabel23.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel23.setText("Senha");

        ckbSSL.setText("SSL");

        ckbTLS.setText("TLS");

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtNome)
                    .addComponent(txtEmail)
                    .addComponent(txtHost)
                    .addComponent(txtUsuario)
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(jLabel21, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jLabel18, javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel19, javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(nudPorta, javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel20, javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel22, javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel23, javax.swing.GroupLayout.Alignment.LEADING))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(ckbSSL)
                            .addComponent(ckbTLS))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(txtSenha))
                .addContainerGap())
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addComponent(jLabel18)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtNome, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel20)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtEmail, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel19)
                .addGap(1, 1, 1)
                .addComponent(txtHost, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel21)
                    .addComponent(ckbSSL))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(nudPorta, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(ckbTLS))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel22)
                .addGap(1, 1, 1)
                .addComponent(txtUsuario, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel23)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(txtSenha, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jLabel24.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel24.setText("Assunto");

        jLabel25.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel25.setText("Mensagem");

        txtMensagem.setColumns(20);
        txtMensagem.setRows(5);
        jScrollPane2.setViewportView(txtMensagem);

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel10, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(txtAssunto)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel24)
                            .addComponent(jLabel25))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 356, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jLabel24)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtAssunto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel25)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 85, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Email", jPanel4);

        btnSalvar.setText("Salvar Configurações");
        btnSalvar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSalvarActionPerformed(evt);
            }
        });

        btnCarregarConfig.setText("Carregar Configurações");
        btnCarregarConfig.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCarregarConfigActionPerformed(evt);
            }
        });

        jTabbedPane3.setName("Envio"); // NOI18N

        btnGerarXML.setLabel("Gerar XML");
        btnGerarXML.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnGerarXMLActionPerformed(evt);
            }
        });

        btnEnviar.setText("Enviar");
        btnEnviar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEnviarActionPerformed(evt);
            }
        });

        btnCarregarININFe.setText("Carregar INI NFe");
        btnCarregarININFe.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCarregarININFeActionPerformed(evt);
            }
        });

        btnCarregarXMLNFe.setText("Carregar XML NFe");
        btnCarregarXMLNFe.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCarregarXMLNFeActionPerformed(evt);
            }
        });

        btnLimparLista.setText("Limpar Lista NFe");
        btnLimparLista.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnLimparListaActionPerformed(evt);
            }
        });

        btnImprimirDANFe.setText("Imprimir DANFe");
        btnImprimirDANFe.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnImprimirDANFeActionPerformed(evt);
            }
        });

        btnImprimirPDFDANFe.setText("Imprimir PDF DANFe");
        btnImprimirPDFDANFe.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnImprimirPDFDANFeActionPerformed(evt);
            }
        });

        btnEnviarEmail.setText("Enviar Email");
        btnEnviarEmail.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEnviarEmailActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel11Layout = new javax.swing.GroupLayout(jPanel11);
        jPanel11.setLayout(jPanel11Layout);
        jPanel11Layout.setHorizontalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(btnEnviarEmail, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnCarregarININFe, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnGerarXML, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnImprimirDANFe, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(28, 28, 28)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(btnCarregarXMLNFe, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnEnviar, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnImprimirPDFDANFe, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(btnLimparLista, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(22, Short.MAX_VALUE))
        );
        jPanel11Layout.setVerticalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnGerarXML)
                    .addComponent(btnEnviar))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnCarregarININFe)
                    .addComponent(btnCarregarXMLNFe))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnImprimirDANFe)
                    .addComponent(btnImprimirPDFDANFe))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnEnviarEmail)
                    .addComponent(btnLimparLista))
                .addContainerGap(57, Short.MAX_VALUE))
        );

        jTabbedPane3.addTab("Envio", jPanel11);

        btnConfigUF.setText("Configuração UF");
        btnConfigUF.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnConfigUFActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(btnConfigUF)
                .addContainerGap(181, Short.MAX_VALUE))
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(btnConfigUF, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(159, Short.MAX_VALUE))
        );

        jTabbedPane3.addTab("Consultas", jPanel12);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(btnCarregarConfig)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(btnSalvar))
                    .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 381, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jTabbedPane3))
                .addContainerGap(28, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jTabbedPane3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(jPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGap(40, 40, 40))
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 500, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(btnSalvar)
                            .addComponent(btnCarregarConfig))
                        .addContainerGap(23, Short.MAX_VALUE))))
        );

        jTabbedPane3.getAccessibleContext().setAccessibleName("Envio");

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents
    
    private void formWindowActivated(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowActivated
        try {
            // Altera as config de log
            Path pathLog = Paths.get(System.getProperty("user.dir"), "Log");
            if (!Files.isDirectory(pathLog)) {
                pathLog.toFile().mkdirs();
            }

            acbrGNRe.configGravarValor(ACBrSessao.Principal, "LogNivel", 4);
            acbrGNRe.configGravarValor(ACBrSessao.Principal, "LogPath", pathLog.toString());
            acbrGNRe.configGravar();

            loadConfig();
        } catch (Exception ex) {
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_formWindowActivated

    private void btnCarregarConfigActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCarregarConfigActionPerformed
        try{
         JFileChooser chooser = new JFileChooser();
         OpenFileFilter filter = new OpenFileFilter("ini", "Arquivo .ini (*.ini)");
         chooser.addChoosableFileFilter(filter);
         chooser.setFileFilter(filter);
         
         if (chooser.showOpenDialog(this) != JFileChooser.APPROVE_OPTION) return;
        }catch (Exception ex){
         Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
        
    }//GEN-LAST:event_btnCarregarConfigActionPerformed

    private void btnSalvarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSalvarActionPerformed
        saveConfig();
    }//GEN-LAST:event_btnSalvarActionPerformed

    private void btnSelectCertActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSelectCertActionPerformed
        try{
            JFileChooser chooser = new JFileChooser();
            OpenFileFilter filter = new OpenFileFilter("pfx", "Certificado igital (*.pfx)");
            chooser.addChoosableFileFilter(filter);
            chooser.setFileFilter(filter);

            if (chooser.showOpenDialog(this) != JFileChooser.APPROVE_OPTION) return;
            txtCertPath.setText(chooser.getSelectedFile().getPath());
        } catch (Exception ex) {
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnSelectCertActionPerformed

    private void btnSelectCert1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSelectCert1ActionPerformed
        try {
            JFileChooser chooser = new JFileChooser();
            chooser.setCurrentDirectory(new java.io.File("."));
            chooser.setDialogTitle("Selecione o diretorio");
            chooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            chooser.setAcceptAllFileFilterUsed(false);

            if (chooser.showOpenDialog(this) != JFileChooser.APPROVE_OPTION)return;
            txtArqGNRe.setText(chooser.getCurrentDirectory().getPath());
        } catch (Exception ex) {
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnSelectCert1ActionPerformed

    private void rdbProducaoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rdbProducaoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_rdbProducaoActionPerformed

    private void btnDadosPFXActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnDadosPFXActionPerformed
         try{
            JFileChooser chooser = new JFileChooser();
            OpenFileFilter filter = new OpenFileFilter("pfx", "Certificado igital (*.pfx)");
            chooser.addChoosableFileFilter(filter);
            chooser.setFileFilter(filter);

            if (chooser.showOpenDialog(this) != JFileChooser.APPROVE_OPTION) return;
            txtCertPath.setText(chooser.getSelectedFile().getPath());
        } catch (Exception ex) {
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnDadosPFXActionPerformed

    private void btnConfigUFActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnConfigUFActionPerformed
        try{
            String eUF = null;
            String ret = acbrGNRe.Consultar(eUF, FRAMEBITS);
            rtbRespostas.append(ret);
        }catch (Exception ex){
           Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnConfigUFActionPerformed

    private void btnGerarXMLActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnGerarXMLActionPerformed
        try {
            acbrGNRe.limparLista();
            String arquivoIni = null;
            JFileChooser chooser = new JFileChooser();
            OpenFileFilter filter = new OpenFileFilter("ini", "Arquivo Ini (*.ini)");
            chooser.addChoosableFileFilter(filter);
            chooser.setFileFilter(filter);
                if (chooser.showOpenDialog(this) != JFileChooser.APPROVE_OPTION) return;
                acbrGNRe.carregarIni(arquivoIni);
                
                acbrGNRe.assinar();
                String ret = acbrGNRe.obterXml(0);
                rtbRespostas.append(ret);
                
        }catch (Exception ex){
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnGerarXMLActionPerformed

    private void btnCarregarININFeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCarregarININFeActionPerformed
        try {
            acbrGNRe.limparLista();
            String arquivoIni = null;
            JFileChooser chooser = new JFileChooser();
            OpenFileFilter filter = new OpenFileFilter("ini", "Arquivo Ini (*.ini)");
            chooser.addChoosableFileFilter(filter);
            chooser.setFileFilter(filter);
            if (chooser.showOpenDialog(this) != JFileChooser.APPROVE_OPTION) return;
            acbrGNRe.carregarIni(arquivoIni);
        } catch (Exception ex) {
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
            
    }//GEN-LAST:event_btnCarregarININFeActionPerformed

    private void btnImprimirDANFeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnImprimirDANFeActionPerformed
        try{
            acbrGNRe.LimparListaGuiaRetorno();
            String arquivoXml = null;
            JFileChooser chooser = new JFileChooser();
            OpenFileFilter filter = new OpenFileFilter("xml", "Arquivo XML (*.xml)");
            chooser.addChoosableFileFilter(filter);
                if (chooser.showOpenDialog(this) != JFileChooser.APPROVE_OPTION) return;
                acbrGNRe.CarregarGuiaRetorno(arquivoXml);
                acbrGNRe.imprimir(arquivoXml, arquivoXml);
        }catch (Exception ex){
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnImprimirDANFeActionPerformed

    private void btnEnviarEmailActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEnviarEmailActionPerformed
        try{
            JFileChooser chooser = new JFileChooser();
            OpenFileFilter filter = new OpenFileFilter("xml", "Arquivo Xml NFe (*.xml)");
            chooser.addChoosableFileFilter(filter);
            chooser.setFileFilter(filter);
            
            if (chooser.showOpenDialog(this) != JFileChooser.APPROVE_OPTION) return;
            String destinatario = JOptionPane.showInputDialog(this,"Digite o e-mail do destinatario","Envio email", JOptionPane.PLAIN_MESSAGE);
            
            acbrGNRe.enviarEmail(destinatario, chooser.getSelectedFile().getAbsolutePath(), true, txtAssunto.getText(), "", "", txtMensagem.getText());
        }catch (Exception ex){
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnEnviarEmailActionPerformed

    private void btnEnviarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEnviarActionPerformed
        try {
           int ret = acbrGNRe.enviar();
           rtbRespostas.append(Integer.toString(ret));
        } catch (Exception ex) {
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnEnviarActionPerformed

    private void btnCarregarXMLNFeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCarregarXMLNFeActionPerformed
        try {
            acbrGNRe.LimparListaGuiaRetorno();
            String arquivoXml = null;
            JFileChooser chooser = new JFileChooser();
            OpenFileFilter filter = new OpenFileFilter("xml", "Arquivo XML (*.xml)");
            chooser.addChoosableFileFilter(filter);
                if (chooser.showOpenDialog(this) != JFileChooser.APPROVE_OPTION) return;
                acbrGNRe.carregarXml(arquivoXml);
        } catch (Exception ex) {
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnCarregarXMLNFeActionPerformed

    private void btnImprimirPDFDANFeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnImprimirPDFDANFeActionPerformed
        
    }//GEN-LAST:event_btnImprimirPDFDANFeActionPerformed

    private void btnLimparListaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnLimparListaActionPerformed
        try {
            acbrGNRe.limparLista();
        } catch (Exception ex) {
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnLimparListaActionPerformed

    private void btnPastaLogsActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnPastaLogsActionPerformed
        try {
            JFileChooser chooser = new JFileChooser();
            chooser.setCurrentDirectory(new java.io.File("."));
            chooser.setDialogTitle("Selecione diretorio");
            chooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            chooser.setAcceptAllFileFilterUsed(false);
            
            if (chooser.showOpenDialog(this) != JFileChooser.APPROVE_OPTION)return;
            txtPastaLogs.setText(chooser.getCurrentDirectory().getPath());
        } catch (Exception ex) {
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnPastaLogsActionPerformed

    private void btnPastaSchemasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnPastaSchemasActionPerformed
        try {
            JFileChooser chooser = new JFileChooser();
            chooser.setCurrentDirectory(new java.io.File("."));
            chooser.setDialogTitle("Selecione o diretorio");
            chooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            chooser.setAcceptAllFileFilterUsed(false);

            if (chooser.showOpenDialog(this) != JFileChooser.APPROVE_OPTION)return;
            txtPastaSchema.setText(chooser.getCurrentDirectory().getPath());
        } catch (Exception ex) {
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnPastaSchemasActionPerformed

    private void loadConfig() {
        try {
            acbrGNRe.configLer();
            cmbCrypt.setSelectedIndex(Integer.parseInt(acbrGNRe.configLerValor(ACBrSessao.DFe, "SSLCryptLib")));            
            cmbHttp.setSelectedIndex(Integer.parseInt(acbrGNRe.configLerValor(ACBrSessao.DFe, "SSLHttpLib")));    
            cmbXmlSign.setSelectedIndex(Integer.parseInt(acbrGNRe.configLerValor(ACBrSessao.DFe, "SSLXmlSignLib")));
            txtCertPath.setText(acbrGNRe.configLerValor(ACBrSessao.DFe, "ArquivoPFX"));
            txtCertPassword.setText(acbrGNRe.configLerValor(ACBrSessao.DFe, "Senha"));
            txtCertNumero.setText(acbrGNRe.configLerValor(ACBrSessao.DFe, "NumeroSerie"));
            cmbUfDestino.setSelectedItem(acbrGNRe.configLerValor(ACBrSessao.DFe, "UF"));
            
            String ambiente = acbrGNRe.configLerValor(ACBrSessao.CTe, "Ambiente");            
            rdbHomologacao.setSelected("1".equals(ambiente));
            rdbProducao.setSelected("0".equals(ambiente));
                        
            cmbSSlType.setSelectedIndex(Integer.parseInt(acbrGNRe.configLerValor(ACBrSessao.CTe, "SSLType"))); 
            nudTimeOut.setValue(Integer.parseInt(acbrGNRe.configLerValor(ACBrSessao.CTe, "Timeout")));
            txtProxyServidor.setText(acbrGNRe.configLerValor(ACBrSessao.Proxy, "Servidor"));
            String Value = acbrGNRe.configLerValor(ACBrSessao.Proxy, "Porta");
            if(Value.matches("-?\\d+"))
                nudProxyPorta.setValue(Integer.parseInt(Value));
            txtProxyUsuario.setText(acbrGNRe.configLerValor(ACBrSessao.Proxy, "Usuario"));
            txtProxySenha.setText(acbrGNRe.configLerValor(ACBrSessao.Proxy, "Senha"));
            txtNome.setText(acbrGNRe.configLerValor(ACBrSessao.Email, "Nome"));
            txtEmail.setText(acbrGNRe.configLerValor(ACBrSessao.Email, "Conta"));
            txtUsuario.setText(acbrGNRe.configLerValor(ACBrSessao.Email, "Usuario"));
            txtSenha.setText(acbrGNRe.configLerValor(ACBrSessao.Email, "Senha"));
            txtHost.setText(acbrGNRe.configLerValor(ACBrSessao.Email, "Servidor"));
            Value = acbrGNRe.configLerValor(ACBrSessao.Email, "Porta");
            if(Value.matches("-?\\d+"))
                nudPorta.setValue(Integer.parseInt(Value));          
            ckbSSL.setSelected(acbrGNRe.configLerValor(ACBrSessao.Email, "SSL").equals("1"));            
            ckbTLS.setSelected(acbrGNRe.configLerValor(ACBrSessao.Email, "TLS").equals("1"));

        } catch (Exception ex) {
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    private void saveConfig() {
        try {
            //Config Geral
            acbrGNRe.configGravarValor(GNRe, "ExibirErroSchema", chkExibirErroSchema.isSelected());
            acbrGNRe.configGravarValor(GNRe, "FormatoAlerta", txtFormatAlerta.getText());
            acbrGNRe.configGravarValor(GNRe, "FormaEmissao", cmbFormaEmissao.getSelectedIndex());
            acbrGNRe.configGravarValor(GNRe, "VersaoDF", cmbVersDocFiscal.getSelectedIndex());
            acbrGNRe.configGravarValor(GNRe, "RetirarAcentos", chkRetAcentXMLsEnv.isSelected());
            acbrGNRe.configGravarValor(GNRe, "SalvarWS", chkSalArqEnvEResp.isSelected());
            acbrGNRe.configGravarValor(GNRe, "PathSalvar", txtPastaLogs.getText());
            acbrGNRe.configGravarValor(GNRe, "PathSchemas", txtPastaSchema.getText());
            
            //Config WebService
            acbrGNRe.configGravarValor(DFe, "UF", cmbUfDestino.getSelectedIndex());
            acbrGNRe.configGravarValor(GNRe, "SSLType", cmbSSlType.getSelectedIndex());
            acbrGNRe.configGravarValor(GNRe, "Timeout", nudTimeOut.getValue().toString());
            acbrGNRe.configGravarValor(GNRe, "Ambiente", rdbHomologacao.isSelected() ? "1":"0");
            acbrGNRe.configGravarValor(GNRe, "Visualizar", chkVisualizarmsg.isSelected());
            acbrGNRe.configGravarValor(GNRe, "SalvarWS", chkSalvarEnvelopeSOAP.isSelected());
            acbrGNRe.configGravarValor(GNRe, "AjustaAguardaConsultaRet", chkAjustarAut.isSelected());
            acbrGNRe.configGravarValor(GNRe, "AguardarConsultaRet", nudAguardar.getValue());
            acbrGNRe.configGravarValor(GNRe, "Tentativas", nudTentativas.getValue());
            acbrGNRe.configGravarValor(GNRe, "IntervaloTentativas", nudIntervalos.getValue());
            acbrGNRe.configGravarValor(Proxy, "Servidor", txtProxyServidor.getText());
            acbrGNRe.configGravarValor(Proxy, "Porta", nudProxyPorta.getValue());
            acbrGNRe.configGravarValor(Proxy, "Usuario", txtProxyUsuario.getText());
            acbrGNRe.configGravarValor(Proxy, "Senha", txtProxySenha.getPassword());
            
            //Config Certificado
            acbrGNRe.configGravarValor(DFe, "SSLCryptLib", cmbCrypt.getSelectedIndex());
            acbrGNRe.configGravarValor(DFe, "SSLHttpLib", cmbHttp.getSelectedIndex());
            acbrGNRe.configGravarValor(DFe, "SSLXmlSignLib", cmbXmlSign.getSelectedIndex());
            acbrGNRe.configGravarValor(DFe, "ArquivoPFX", txtCertPath.getText());
            acbrGNRe.configGravarValor(DFe, "DadosPFX", txtDadosPFX.getText());
            acbrGNRe.configGravarValor(DFe, "Senha", txtCertPassword.getPassword());
            acbrGNRe.configGravarValor(DFe, "NumeroSerie", txtCertNumero.getText());
            
            //Confi Arquivos
            acbrGNRe.configGravarValor(GNRe, "SalvarGer", chkSalArqEnvEResp.isSelected());
            acbrGNRe.configGravarValor(GNRe, "SepararPorMes", ckbPastaMensal.isSelected());
            acbrGNRe.configGravarValor(GNRe, "AdicionarLiteral", ckbAdicionaLiteral.isSelected());
            acbrGNRe.configGravarValor(GNRe, "EmissaoPathGNRe", ckbEmissaoPathGNRe.isSelected());
            acbrGNRe.configGravarValor(GNRe, "SepararPorCNPJ", ckbSepararPorCNPJ.isSelected());
            acbrGNRe.configGravarValor(GNRe, "SepararPorModelo", ckbSepararPorModelo.isSelected());
            acbrGNRe.configGravarValor(GNRe, "PathGNRe", txtArqGNRe.getText());
            
            //Config Email
            acbrGNRe.configGravarValor(ACBrSessao.Email, "Nome", txtNome.getText());
            acbrGNRe.configGravarValor(ACBrSessao.Email, "Conta", txtEmail.getText());
            acbrGNRe.configGravarValor(ACBrSessao.Email, "Usuario", txtUsuario.getText());
            acbrGNRe.configGravarValor(ACBrSessao.Email, "Senha", new String(txtSenha.getPassword()));
            acbrGNRe.configGravarValor(ACBrSessao.Email, "Servidor", txtHost.getText());         
            acbrGNRe.configGravarValor(ACBrSessao.Email, "Porta", nudPorta.getValue().toString());     
            acbrGNRe.configGravarValor(ACBrSessao.Email, "SSL", ckbSSL.isSelected());
            acbrGNRe.configGravarValor(ACBrSessao.Email, "TLS",ckbTLS.isSelected());
                        
             acbrGNRe.configGravar();            
            
        } catch (Exception ex) {
            Logger.getLogger(FrmMain.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnCarregarConfig;
    private javax.swing.JButton btnCarregarININFe;
    private javax.swing.JButton btnCarregarXMLNFe;
    private javax.swing.JButton btnConfigUF;
    private javax.swing.JButton btnDadosPFX;
    private javax.swing.JButton btnEnviar;
    private javax.swing.JButton btnEnviarEmail;
    private javax.swing.JButton btnGerarXML;
    private javax.swing.JButton btnImprimirDANFe;
    private javax.swing.JButton btnImprimirPDFDANFe;
    private javax.swing.JButton btnLimparLista;
    private javax.swing.JButton btnObterCertificados;
    private javax.swing.JButton btnPastaLogs;
    private javax.swing.JButton btnPastaSchemas;
    private javax.swing.JButton btnSalvar;
    private javax.swing.JButton btnSelectCert;
    private javax.swing.JButton btnSelectCert1;
    private javax.swing.JCheckBox chkAjustarAut;
    private javax.swing.JCheckBox chkExibirErroSchema;
    private javax.swing.JCheckBox chkRetAcentXMLsEnv;
    private javax.swing.JCheckBox chkSalArqEnvEResp;
    private javax.swing.JCheckBox chkSalvarEnvelopeSOAP;
    private javax.swing.JCheckBox chkVisualizarmsg;
    private javax.swing.JCheckBox ckbAdicionaLiteral;
    private javax.swing.JCheckBox ckbEmissaoPathGNRe;
    private javax.swing.JCheckBox ckbPastaMensal;
    private javax.swing.JCheckBox ckbSSL;
    private javax.swing.JCheckBox ckbSalvarArqs;
    private javax.swing.JCheckBox ckbSepararPorCNPJ;
    private javax.swing.JCheckBox ckbSepararPorModelo;
    private javax.swing.JCheckBox ckbTLS;
    private javax.swing.JComboBox<String> cmbCrypt;
    private javax.swing.JComboBox<String> cmbFormaEmissao;
    private javax.swing.JComboBox<String> cmbHttp;
    private javax.swing.JComboBox<String> cmbSSlType;
    private javax.swing.JComboBox<String> cmbUfDestino;
    private javax.swing.JComboBox<String> cmbVersDocFiscal;
    private javax.swing.JComboBox<String> cmbXmlSign;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel14;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JTabbedPane jTabbedPane3;
    private javax.swing.JLabel lblAguardar;
    private javax.swing.JLabel lblDadosPFX;
    private javax.swing.JLabel lblFormaEmissao1;
    private javax.swing.JLabel lblFormatoAlerta;
    private javax.swing.JLabel lblIntervalo;
    private javax.swing.JLabel lblTentativas;
    private javax.swing.JLabel lblVersDocFiscal;
    private javax.swing.JLabel lblVersDocFiscal1;
    private javax.swing.JLabel lblVersDocFiscal2;
    private javax.swing.JSpinner nudAguardar;
    private javax.swing.JSpinner nudIntervalos;
    private javax.swing.JSpinner nudPorta;
    private javax.swing.JSpinner nudProxyPorta;
    private javax.swing.JSpinner nudTentativas;
    private javax.swing.JSpinner nudTimeOut;
    private javax.swing.JRadioButton rdbHomologacao;
    private javax.swing.JRadioButton rdbProducao;
    private javax.swing.JTextArea rtbRespostas;
    private javax.swing.JTextField txtArqGNRe;
    private javax.swing.JTextField txtAssunto;
    private javax.swing.JTextField txtCertNumero;
    private javax.swing.JPasswordField txtCertPassword;
    private javax.swing.JTextField txtCertPath;
    private javax.swing.JTextField txtDadosPFX;
    private javax.swing.JTextField txtEmail;
    private javax.swing.JTextField txtFormatAlerta;
    private javax.swing.JTextField txtHost;
    private javax.swing.JTextArea txtMensagem;
    private javax.swing.JTextField txtNome;
    private javax.swing.JTextField txtPastaLogs;
    private javax.swing.JTextField txtPastaSchema;
    private javax.swing.JPasswordField txtProxySenha;
    private javax.swing.JTextField txtProxyServidor;
    private javax.swing.JTextField txtProxyUsuario;
    private javax.swing.JPasswordField txtSenha;
    private javax.swing.JTextField txtUsuario;
    // End of variables declaration//GEN-END:variables
}
